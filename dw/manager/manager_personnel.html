<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="renderer" content="webkit">
	<meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=no">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">

	<link rel="stylesheet" href="../../css/reset.css">
	<link rel="stylesheet" href="../../css/share.css">
	<link rel="stylesheet" href="../../css/personnel.css">
	<link rel="stylesheet" href="../../lib/bootstrap-3.3.7-dist/css/bootstrap.min.css">
	<link rel="stylesheet" href="../../lib/jQueryZdialog/css/zdialog.css">

	<script src="../../lib/jquery-1.11.3/jquery.min.js"></script>
	<script src="../../lib/jQueryZdialog/js/zdialog.js"></script>
	<script src="../../lib/bootstrap-3.3.7-dist/js/bootstrap.min.js"></script>
	<script src="../../js/common.js"></script>


	<title>维护人员</title>
	<style>
		body{
			padding-bottom: 80px;
		}
		.main-cont-box{
			height: auto;
		}
		.warp-btn-box{
			display: none;
		}
		.btn-box button{
			height: auto;
			outline: none !important;
		}
		.wrap-select-box{
			box-shadow: -3px 3px 4px 0px rgba(59,159,218,0.24);
		}
		.more{
			color: #ffa810 !important;
		}
		.home-nav{
			display: block;
			width: 2rem;
			height: 2rem;
			background: url(../../images/nav-wd-q_3.png) no-repeat center;
			background-size: 100% 100%;
			margin: 0 auto;
		}
		.path-nav{
			display: block;
			width: 2rem;
			height: 2rem;
			background: url(../../images/nav-xl-q.png) no-repeat center;
			background-size: 100% 100%;
			margin: 0 auto;
		}
		.add-nav{
			display: block;
			width: 2rem;
			height: 2rem;
			background: url(../../images/nav-fb.png) no-repeat center;
			background-size: 100% 100%;
			margin: 0 auto;
		}
		.personnel-nav{
			display: block;
			width: 2rem;
			height: 2rem;
			background: url(../../images/nav-wd-renyuan1.png) no-repeat center;
			background-size: 100% 100%;
			margin: 0 auto;
		}
		.my-nav{
			display: block;
			width: 2rem;
			height: 2rem;
			background: url(../../images/nav-wd-q.png) no-repeat center;
			background-size: 100% 100%;
			margin: 0 auto;
		}
	</style>
</head>

<body>
	<!--头部-->
	<div class="wrap-head-box">
		<div class="main-head-box">
			<div class="container-fluid">
				<div class="row">
					<div class="col-md-2 col-xs-3" id="choice">
						<p>选择操作</p>
					</div>
					<div class="col-md-8 col-xs-6">
						<h2>维护人员</h2>
					</div>
					<div class="col-md-2 col-xs-3" id="find">
						<p>添加</p>
					</div>
				</div>
			</div>
		</div>

	</div>
	<!--筛选-->
	<div class="wrap-select-box">
		<div class="container-fluid">
			<div class="tc sl_tc">
				<span>排序</span>
				<i class="select-ico"></i>
			</div>
		</div>
		<!-- 排序 -->
		<div class="paixu">
				<p>添加时间升序</p>
				<p>添加时间降序</p>
				<p><small>收起</small></p>
			</div>
			<!-- 排序遮罩 -->
		<div class="paixu_zhezhao"></div>
	</div>
	<!-- 选择操作按钮 -->
	<div class="warp-btn-box">
		<div class="container-fluid">
			<div class="btn-box">
				<button type="button" class="btn btn-primary">删除</button>
				<div class="clear"></div>
			</div>
		</div>
	</div>
	<!--内容-->
	<div class="wrap-cont-box">
		<div class="container">
			<!-- <div class="main-cont-box">
				<div class="message-cont-box">
					<h3>赵铁柱</h3>
					<div>
						<p>最后操作时间：<span>五天前</span></p>
						<p>2019-04-23 11:20:30</p>
					</div>
					<div>
						<p>今日录入信息：<span>10</span>条</p>
						<p>历史录入信息：<span>10</span>条</p>
					</div>
				</div>
				<div class="region-cont-box">
					<div class="row">
						<div class="col-md-5 col-xs-5 start-cont-box tc">
							<p>山东/临沂</p>
						</div>
						<div class="col-md-2 col-xs-2 arrows-cont-box">
							<span class="arrows-one"></span>
							<span class="arrows-two"></span>
						</div>
						<div class="col-md-5 col-xs-5 getTo-cont-box tc">
							<p>江苏/南京</p>
						</div>
						<div class="row" style="clear: both; text-align: center;font-size: 1rem">
								<p class="more">查看详情</p>
						</div>
					</div>
				</div>
			</div> -->
			<!-- <div class="main-cont-box">
					<div class="message-cont-box">
						<h3>赵铁柱</h3>
						<div>
							<p>最后操作时间：<span>五天前</span></p>
							<p>2019-04-23 11:20:30</p>
						</div>
						<div>
							<p>今日录入信息：<span>10</span>条</p>
							<p>历史录入信息：<span>10</span>条</p>
						</div>
					</div>
					<div class="region-cont-box">
						<div class="row">
							<div class="col-md-5 col-xs-5 start-cont-box tc">
								<p>山东/临沂</p>
							</div>
							<div class="col-md-2 col-xs-2 arrows-cont-box">
								<span class="arrows-one"></span>
								<span class="arrows-two"></span>
							</div>
							<div class="col-md-5 col-xs-5 getTo-cont-box tc">
								<p>江苏/南京</p>
							</div>
						
							<div class="row" style="clear: both; text-align: center;font-size: 1rem">
									<p class="more">查看详情</p>
							</div>
						</div>
					</div>
				</div>
				<div class="main-cont-box">
						<div class="message-cont-box">
							<h3>赵铁柱</h3>
							<div>
								<p>最后操作时间：<span>五天前</span></p>
								<p>2019-04-23 11:20:30</p>
							</div>
							<div>
								<p>今日录入信息：<span>10</span>条</p>
								<p>历史录入信息：<span>10</span>条</p>
							</div>
						</div>
						<div class="region-cont-box">
							<div class="row">
								<div class="col-md-5 col-xs-5 start-cont-box tc">
									<p>山东/临沂</p>
								</div>
								<div class="col-md-2 col-xs-2 arrows-cont-box">
									<span class="arrows-one"></span>
									<span class="arrows-two"></span>
								</div>
								<div class="col-md-5 col-xs-5 getTo-cont-box tc">
									<p>江苏/南京</p>
								</div>
								<div class="row" style="clear: both; text-align: center;font-size: 1rem">
										<p class="more">查看详情</p>
								</div>
							</div>
						</div>
					</div>
					<div class="main-cont-box">
							<div class="message-cont-box">
								<h3>赵铁柱</h3>
								<div>
									<p>最后操作时间：<span>五天前</span></p>
									<p>2019-04-23 11:20:30</p>
								</div>
								<div>
									<p>今日录入信息：<span>10</span>条</p>
									<p>历史录入信息：<span>10</span>条</p>
								</div>
							</div>
							<div class="region-cont-box">
								<div class="row">
									<div class="col-md-5 col-xs-5 start-cont-box tc">
										<p>山东/临沂</p>
									</div>
									<div class="col-md-2 col-xs-2 arrows-cont-box">
										<span class="arrows-one"></span>
										<span class="arrows-two"></span>
									</div>
									<div class="col-md-5 col-xs-5 getTo-cont-box tc">
										<p>江苏/南京</p>
									</div>
									<div class="row" style="clear: both; text-align: center;font-size: 1rem">
											<p class="more">查看详情</p>
									</div>
								</div>
							</div>
						</div>
						<div class="main-cont-box">
								<div class="message-cont-box">
									<h3>赵铁柱</h3>
									<div>
										<p>最后操作时间：<span>五天前</span></p>
										<p>2019-04-23 11:20:30</p>
									</div>
									<div>
										<p>今日录入信息：<span>10</span>条</p>
										<p>历史录入信息：<span>10</span>条</p>
									</div>
								</div>
								<div class="region-cont-box">
									<div class="row">
										<div class="col-md-5 col-xs-5 start-cont-box tc">
											<p>山东/临沂</p>
										</div>
										<div class="col-md-2 col-xs-2 arrows-cont-box">
											<span class="arrows-one"></span>
											<span class="arrows-two"></span>
										</div>
										<div class="col-md-5 col-xs-5 getTo-cont-box tc">
											<p>江苏/南京</p>
										</div>
										<div class="row" style="clear: both; text-align: center;font-size: 1rem">
												<p class="more">查看详情</p>
										</div>
									</div>
								</div>
							</div>
							<div class="main-cont-box">
									<div class="message-cont-box">
										<h3>赵铁柱</h3>
										<div>
											<p>最后操作时间：<span>五天前</span></p>
											<p>2019-04-23 11:20:30</p>
										</div>
										<div>
											<p>今日录入信息：<span>10</span>条</p>
											<p>历史录入信息：<span>10</span>条</p>
										</div>
									</div>
									<div class="region-cont-box">
										<div class="row">
											<div class="col-md-5 col-xs-5 start-cont-box tc">
												<p>山东/临沂</p>
											</div>
											<div class="col-md-2 col-xs-2 arrows-cont-box">
												<span class="arrows-one"></span>
												<span class="arrows-two"></span>
											</div>
											<div class="col-md-5 col-xs-5 getTo-cont-box tc">
												<p>江苏/南京</p>
											</div>
											<div class="row" style="clear: both; text-align: center;font-size: 1rem">
													<p class="more">查看详情</p>
											</div>
										</div>
									</div>
								</div> -->
		
							
		</div>
	</div>
	<!--底部导航-->
	<div class="wrap-nav-box tc">
		<div class="list-nav-box">
			<i class="home-nav"></i>
			<span>首页</span>
		</div>
		<div class="list-nav-box">
			<i class="path-nav"></i>
			<span>线路</span>
		</div>
		<div class="list-nav-box add-nav-box">
			<div class="add-cont-box">
				<i class="add-nav"></i>
			</div>
			<span>发布</span>
		</div>
		<div class="list-nav-box">
			<i class="personnel-nav"></i>
			<span>人员</span>
		</div>
		<div class="list-nav-box">
			<i class="my-nav"></i>
			<span>我的</span>
		</div>
	</div>

	<!-- js部分 -->
	<script type="text/javascript">
		// 点击遮罩收起
		$(".paixu p:eq(2)").click(function () {					
			$(".paixu").hide();
			$(".paixu_zhezhao").hide();
			$("body").css({"position":"static"});                
		})
		// 点击排序弹出
		$(".sl_tc").click(function () {
			$(".paixu").show();
			$(".paixu_zhezhao").show();
			//这是当前滚动的页面滚动条位置
			var top=$(window).scrollTop();
			//此处为当前需要定住的位置 
			$("body").css({"position":"fixed", "width":"100%","top": top*-1});
		})
		// 点击遮罩
		$(".paixu_zhezhao").click(function () {								
			$(".paixu").hide();
			$(".paixu_zhezhao").hide();
			$("body").css({"position":"static"});
		})

		var sort = "";
		// 默认查询
		man_zhezhao (sort);
		$(".paixu p:eq(0)").click(function () {
                sort = "";
				man_zhezhao (sort);
                $(".paixu").hide();
                $(".paixu_zhezhao").hide();
                $("body").css({"position":"static"});
            })
            $(".paixu p:eq(1)").click(function () {
                sort = "desc";
                man_zhezhao (sort);
                $(".paixu").hide();
                $(".paixu_zhezhao").hide();
                $("body").css({"position":"static"});
            })

		
		var flag = false;
		// 点击选择操作
		$("#choice p").click(function () {
			// 加载loading等操作
			$(".paixu_zhezhao").show();
			$(".paixu_zhezhao").css("top", 0)
			$.DialogByZ.Loading('../../lib/jQueryZdialog/image/loading.png');
			setTimeout(function () {
				if (document.querySelectorAll(".paixu")[0].style.display == "block") {
					$.DialogByZ.Close();
					$(".paixu_zhezhao").css("top", "auto");
					$(".more").text("查看详情");
				} else {
					$.DialogByZ.Close();
					$(".paixu_zhezhao").hide();
					$(".paixu_zhezhao").css("top", "auto");
					$(".more").text("查看详情");					
				}
			}, 500)
			flag = true;
			$(".warp-btn-box").show();                
		})
		$(".wrap-cont-box").on("click", ".main-cont-box", function () {
			if (flag == false) {
				var u_id = $(this).attr("wl_id");
				sessionStorage.setItem("man_peo_se", u_id);
				location.href = "manager_personnel_more.html"
			} else {
				$(this).toggleClass("change-active");
			}
		})
		// 点击添加人员
		$("#find").click(function () {
			location.href = "manager_personnel_add.html"
		})
		// 点击线路
		$(".wrap-nav-box").on("click", ".list-nav-box", function () {
			var sale_index = $(this).index();
			switch (sale_index) {
				case 0 : location.href = "manager_index.html"
				break;
				case 1 : location.href = "manager_route.html"
				break;
				case 2 : location.href = "manager_edit.html"
				break;
				case 3 : location.href = "manager_personnel.html"
				break;
				case 4 : location.href = "managet_user.html"
				break;
			}
		})
		
		function man_zhezhao (sort) {
			// $(".wrap-cont-box .container").empty();
			$.ajax({
                type: "post",
                url: global_url + "/sman/getSNameAndWLList",
                data: {
					pageSize: 10000,
					pageNum: 1,
					sort: sort
                },
                success: function (data) {
                    if (data) {
                        per_xuanran (data);
                    } else {
                        setTimeout (function () {
                            if (data.error) {
                                $.DialogByZ.Alert({Title: "", Content: "失败", BtnL:"确定",FunL:alerts});
                            };
                        }, 10)
                    }
                }
            })
		}

		// 渲染
		function per_xuanran (data) {
			$(".wrap-cont-box>.container").empty()
			var str = "";
			var st1 = "";
			var st2 = "";
			var st3 = "";
			var st4 = "";
			for (var i = 0; i < data.rows.length; i++) {
				if (data.data[i].arr[0]) {
					if (data.data[i].arr[0].province_a) {
					str1 = data.data[i].arr[0].province_a
					} else {
						str1 = ""
					}
					if (data.data[i].arr[0].urban_a) {
						str2 = data.data[i].arr[0].urban_a
					} else {
						str2 = ""
					}
					if (data.data[i].arr[0].province_b) {
						str3 = data.data[i].arr[0].province_b
					} else {
						str3 = ""
					}
					if (data.data[i].arr[0].urban_b) {
						str4 = data.data[i].arr[0].urban_b
					} else {
						str4 = ""
					}
				} else {
					str1 = ""
					str2 = ""
					str3 = ""
					str4 = ""
				}
				str = '<div class="main-cont-box" wl_id='+ data.rows[i].u_id+'>' +
									'<div class="message-cont-box">' +
										'<h3>' +data.rows[i].name  +'</h3>' +
										'<div>' +
											'<p>最后操作时间：<span></span></p>' +
											'<p>'+ data.rows[i].lastLogin_time+'</p>' +
										'</div>' +
										'<div>' +
											'<p>今日录入信息：<span>'+ data.data[i].today +'</span>条</p>' +
											'<p>历史录入信息：<span>'+ data.data[i].history +'</span>条</p>' +
										'</div>' +
									'</div>' +
									'<div class="region-cont-box">' +
										'<div class="row">' +
											'<div class="col-md-5 col-xs-5 start-cont-box tc">' +
												'<p>' + str1 + '/' + str2 +'</p>' +
											'</div>' +
											'<div class="col-md-2 col-xs-2 arrows-cont-box">' +
												'<span class="arrows-one"></span>' +
												'<span class="arrows-two"></span>' +
											'</div>' +
											'<div class="col-md-5 col-xs-5 getTo-cont-box tc">' +
												'<p>' + str3 + '/' + str4 +'</p>' +
											'</div>' +
											'<div class="row" style="clear: both; text-align: center;font-size: 1rem">' +
													'<p class="more">查看详情</p>' +
											'</div>' +
										'</div>' +
									'</div>' 

				$(".wrap-cont-box>.container").append(str);
			}
		}

		// 点击删除
		$(".btn-box button").click(function () {
			var arr1 = [];
            for (var i = 0 ; i < $(".wrap-cont-box .container .main-cont-box").length; i++) {
                if ($(".wrap-cont-box .container").find(".main-cont-box").eq(i).attr("class") == "main-cont-box change-active") {
                    arr1.push(i);
                }
			}
            if (arr1.length > 0 ) {
				var arr2 = [];
                for (var i = 0; i < arr1.length; i++) {
                    arr2.push($(".wrap-cont-box .main-cont-box").eq(arr1[i]).attr("wl_id"));
				}
				man_delete (arr2);
            } else {
                $.DialogByZ.Alert({Title: "", Content: "请至少选择一个", BtnL:"确定",FunL:alerts});
            }
		})

		function man_delete (arr2) {
			$.ajax({
                type: "post",
                url: global_url + "/user/deleteSalasManById",
                data: {
					ids: arr2
                },
                success: function (data) {
                    if (data.success) {
						setTimeout(function () {
							$.DialogByZ.Alert({Title: "", Content: "成功", BtnL:"确定",FunL:alerts1234});							
						}, 10)
					} else {
						setTimeout(function () {
							$.DialogByZ.Alert({Title: "", Content: "失败", BtnL:"确定",FunL:alerts});							
						}, 10)
					}
                }
            })
		}
		function alerts1234() {
			history.go(0)
		}
	</script>

</body>

</html>